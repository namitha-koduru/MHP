<!DOCTYPE html>
<html>
<head>
<title>MHP Canteen</title>
<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{background:#c0392b;color:#fff;padding:12px;text-align:center;font-size:20px}
.container{display:flex}
aside{width:220px;background:#2c3e50;color:#fff;height:100vh}
aside li{padding:10px;cursor:pointer}
aside li:hover,aside li.active{background:#34495e}
main{flex:1;padding:15px}
.items{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}
.card{background:#fff;padding:10px;border-radius:8px;text-align:center}
.order-box{width:350px;background:#fff;padding:15px;border-radius:8px;margin-top:15px}
.pay{padding:8px;width:48%;border:none;background:#aaa;color:#fff}
.cart-item{display:flex;justify-content:space-between;font-size:13px}
</style>
</head>

<body>

<header>üçΩÔ∏è MHP Online Canteen</header>

<div class="container">

<aside>
<ul id="cats"></ul>
</aside>

<main>
<div id="items" class="items"></div>

<div class="order-box">
<h3>Order Type</h3>
<label><input type="radio" name="service" value="self" checked onchange="renderCart()"> Self</label>
<label><input type="radio" name="service" value="parcel" onchange="renderCart()"> Parcel</label>

<h3>Payment</h3>
<button class="pay" onclick="setPay('online')" id="on">Online</button>
<button class="pay" onclick="setPay('offline')" id="off">Offline</button>

<h3>Cart</h3>
<div id="cart"></div>
<h3>Total: <span id="total">‚Çπ0</span></h3>

<button onclick="placeOrder()">Place Order</button>
<div id="result"></div>
</div>
</main>
</div>

<script>
const API="http://localhost:5000/api";

if(!localStorage.getItem("mhpUser")) location.href="login.html";

const PARCEL=10;
let payment=null;
let cart={};

const data={
 Biryanis:[["üçó Chicken Biryani",150],["üçõ Dum Biryani",160],["ü•ö Egg Biryani",120]],
 Noodles:[["üçú Veg Noodles",80],["üçú Egg Noodles",100],["üçú Chicken Noodles",120]],
 Drinks:[["ü•§ Cool Drink",25],["‚òï Tea",10],["ü•õ Milkshake",50]],
 Snacks:[["üçî Burger",80],["üçü Fries",60],["ü•ü Samosa",20]],
 Desserts:[["üç® Ice Cream",40],["üç∞ Cake",50],["üç© Gulab Jamun",30]]
};

const cats=document.getElementById("cats");
const items=document.getElementById("items");

Object.keys(data).forEach((c,i)=>{
 let li=document.createElement("li");
 li.innerText="üçΩÔ∏è "+c;
 li.onclick=()=>{document.querySelectorAll("li").forEach(x=>x.classList.remove("active"));li.classList.add("active");load(c);}
 cats.appendChild(li); if(i===0) li.click();
});

function load(cat){
 items.innerHTML="";
 data[cat].forEach(i=>{
  items.innerHTML+=`
  <div class="card">
   <div style="font-size:26px">${i[0].split(" ")[0]}</div>
   <div>${i[0]}</div>
   <div>‚Çπ${i[1]}</div>
   <button onclick="add('${i[0]}',${i[1]})">Add</button>
  </div>`;
 });
}

function add(n,p){ cart[n]?cart[n].qty++:cart[n]={price:p,qty:1}; renderCart();}

function renderCart(){
 let t=0; cartBox.innerHTML="";
 let type=document.querySelector('input[name="service"]:checked').value;
 for(let n in cart){
  let c=cart[n];
  let cost=c.price*c.qty+(type==="parcel"?PARCEL*c.qty:0);
  t+=cost;
  cartBox.innerHTML+=`<div class="cart-item">${n} x ${c.qty}</div>`;
 }
 total.innerText="‚Çπ"+t;
}

function setPay(p){
 payment=p;
 on.style.background=off.style.background="#aaa";
 p==="online"?on.style.background="#27ae60":off.style.background="#e67e22";
}

function placeOrder(){
 if(!payment) return alert("Select payment");

 let items=[];
 for(let n in cart) items.push({name:n,qty:cart[n].qty});

 fetch(API+"/order/place-order",{
  method:"POST",
  headers:{"Content-Type":"application/json"},
  body:JSON.stringify({
    mobile:localStorage.getItem("mhpUser"),
    items,
    total:total.innerText.replace("‚Çπ",""),
    orderType:document.querySelector('input[name="service"]:checked').value,
    paymentMode:payment
  })
 })
 .then(r=>r.json()).then(d=>{
  result.innerHTML=`Payment Successful<br>Order ID: ${d.orderId}<br>Total: ${total.innerText}`;
  cart={}; renderCart();
 });
}

const cartBox=document.getElementById("cart");
const total=document.getElementById("total");
const result=document.getElementById("result");
</script>

</body>
</html>
